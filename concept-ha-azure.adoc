---
sidebar: sidebar 
permalink: concept-ha-azure.html 
keywords: high availability, HA, concepts, understanding, overview, takeover, giveback, rpo, rto, nondisruptive, ha pairs, node, nodes, recovery point objective, recovery time objective, nas, nfs, cifs, iscsi, mpio, alua, failover, failure, azure, shared storage, active, passive, load balancer, availability set, storage accounts, page blobs 
summary: Cloud Volumes ONTAP ハイアベイラビリティ（ HA ）ペアは、クラウド環境で障害が発生した場合にエンタープライズクラスの信頼性と継続的な運用を実現します。Azure では、 2 つのノード間でストレージが共有されます。 
---
= Azure のハイアベイラビリティペア
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Cloud Volumes ONTAP ハイアベイラビリティ（ HA ）ペアは、クラウド環境で障害が発生した場合にエンタープライズクラスの信頼性と継続的な運用を実現します。Azure では、 2 つのノード間でストレージが共有されます。



== HA コンポーネント



=== ページblobを使用したHA単一アベイラビリティゾーン構成

AzureのCloud Volumes ONTAP HAページBLOB構成には、次のコンポーネントが含まれています。

image:diagram_ha_azure.png["ロードバランサがBlueXPおよびクライアントからの着信トラフィックを管理する概念図、可用性セット内の2つのCloud Volumes ONTAP ノード、ブートデータ用のSSDディスク、および顧客データ用のPage Blobを示しています。"]

BlueXPによって導入されるAzureコンポーネントについては、次の点に注意してください。

Azure Standard Load Balancer の略:: ロードバランサは、 Cloud Volumes ONTAP HA ペアへの着信トラフィックを管理します。
可用性セット:: Azure 可用性セットは、 Cloud Volumes ONTAP ノードを論理的にグループ化したものです。可用性セットを使用すると、ノードが異なる障害になっていることを確認し、ドメインを更新して冗長性と可用性を確保できます。 https://docs.microsoft.com/en-us/azure/virtual-machines/availability-set-overview["可用性セットの詳細については、 Azure のドキュメントを参照してください"^]。
ディスク:: お客様のデータは Premium Storage ページの BLOB にあります。各ノードがもう一方のノードのストレージにアクセスできます。には追加のストレージも必要です link:https://docs.netapp.com/us-en/bluexp-cloud-volumes-ontap/reference-default-configs.html#azure-ha-pair["ブート、ルート、およびコアのデータ"^]。
ストレージアカウント::
+
--
* 管理対象ディスクにはストレージアカウントが 1 つ必要です。
* ストレージ・アカウントあたりのディスク容量の上限に達しているため ' プレミアム・ストレージ・ページ・ブロブには 1 つ以上のストレージ・アカウントが必要です
+
https://docs.microsoft.com/en-us/azure/storage/common/storage-scalability-targets["Azure のドキュメント：「 Azure Storage スケーラビリティー and performance targets for storage accounts"^]。

* Azure BLOB ストレージへのデータ階層化には 1 つのストレージアカウントが必要です。
* Cloud Volumes ONTAP 9.7以降では、HAペア用にBlueXPで作成されるストレージアカウントは汎用v2のストレージアカウントです。
* 作業環境の作成時に、 Cloud Volumes ONTAP 9.7 HA ペアから Azure ストレージアカウントへの HTTPS 接続を有効にすることができます。このオプションを有効にすると、書き込みパフォーマンスに影響する可能性があります。作業環境の作成後に設定を変更することはできません。


--




=== 共有管理対象ディスクを使用するHAシングルアベイラビリティゾーン構成

共有管理対象ディスク上で実行されるCloud Volumes ONTAP HAシングルアベイラビリティゾーン構成には、次のコンポーネントが含まれます。

image:diagram_ha_azure_saz_lrs.png["ロードバランサがBlueXPおよびクライアントからの着信トラフィックを管理する概念図、可用性セット内の2つのCloud Volumes ONTAP ノード、ブートデータ用のSSDディスク、顧客データ用のLRS管理ディスクを示しています。"]

BlueXPによって導入されるAzureコンポーネントについては、次の点に注意してください。

Azure Standard Load Balancer の略:: ロードバランサは、 Cloud Volumes ONTAP HA ペアへの着信トラフィックを管理します。
可用性セット:: Azure 可用性セットは、 Cloud Volumes ONTAP ノードを論理的にグループ化したものです。可用性セットを使用すると、ノードが異なる障害になっていることを確認し、ドメインを更新して冗長性と可用性を確保できます。 https://docs.microsoft.com/en-us/azure/virtual-machines/availability-set-overview["可用性セットの詳細については、 Azure のドキュメントを参照してください"^]。
ディスク:: お客様のデータは、ローカル冗長ストレージ（LRS）管理対象ディスクに格納されています。各ノードがもう一方のノードのストレージにアクセスできます。には追加のストレージも必要です link:https://docs.netapp.com/us-en/bluexp-cloud-volumes-ontap/reference-default-configs.html#azure-ha-pair["ブート、ルート、パートナーのルート、コア、NVRAMの各データ"^]。
ストレージアカウント:: ストレージアカウントは、診断ログの処理とBLOBストレージへの階層化を行うディスクベースの管理環境で使用されます。




=== HAの複数のアベイラビリティゾーン構成

AzureのCloud Volumes ONTAP HAマルチアベイラビリティゾーン構成には、次のコンポーネントが含まれています。

image:diagram_ha_azure_maz.png["ロードバランサがBlueXPとクライアントからの着信トラフィックを管理する概念図、2つのアベイラビリティゾーンにある2つのCloud Volumes ONTAP ノード、ブートデータ用のSSDディスク、および顧客データ用の管理対象ディスクを示しています。"]

BlueXPによって導入されるAzureコンポーネントについては、次の点に注意してください。

Azure Standard Load Balancer の略:: ロードバランサは、 Cloud Volumes ONTAP HA ペアへの着信トラフィックを管理します。
可用性ゾーン:: 2つのCloud Volumes ONTAP ノードが異なるアベイラビリティゾーンに導入されています。アベイラビリティゾーンを使用すると、各ノードが異なる障害ドメインに配置されます。 https://learn.microsoft.com/en-us/azure/virtual-machines/disks-redundancy#zone-redundant-storage-for-managed-disks["Azureゾーン冗長ストレージの詳細については、Azureのドキュメントを参照してください"^]。
ディスク:: お客様のデータは、ゾーン冗長ストレージ（ZRS）管理ディスクに格納されています。各ノードがもう一方のノードのストレージにアクセスできます。には追加のストレージも必要です link:https://docs.netapp.com/us-en/bluexp-cloud-volumes-ontap/reference-default-configs.html#azure-ha-pair["ブート、ルート、パートナールート、コアの各データ"^]。
ストレージアカウント:: ストレージアカウントは、診断ログの処理とBLOBストレージへの階層化を行うディスクベースの管理環境で使用されます。




== RPO と RTO

HA 構成では、次のようにデータの高可用性が維持されます。

* RPO （ Recovery Point Objective ：目標復旧時点）は 0 秒です。
データはトランザクション的に整合性が保たれ、データ損失は発生しません。
* Recovery Time Objective（RTO；目標復旧時間）は120秒です。
システム停止が発生した場合、120秒以内にデータを利用できるようにする必要があります。




== ストレージのテイクオーバーとギブバック

物理 ONTAP クラスタと同様に、 Azure HA ペアのストレージはノード間で共有されます。パートナーのストレージに接続することで、 _TAKEOVER_中 に各ノードがもう一方のストレージにアクセスできるようになります。ネットワークパスのフェイルオーバーメカニズムにより、クライアントとホストは稼働しているノードと引き続き通信できます。ノードがオンラインに戻ったときに、 partner_ギ ブバック _storage を提供します。

NAS 構成の場合は、障害の発生時にデータ IP アドレスが HA ノード間で自動的に移行されます。

iSCSI の場合、 ONTAP はマルチパス I/O （ MPIO ）と非対称論理ユニットアクセス（ ALUA ）を使用して、アクティブ最適化パスと非最適化パス間のパスフェイルオーバーを管理します。


NOTE: ALUA をサポートする具体的なホスト構成については、を参照してください http://mysupport.netapp.com/matrix["NetApp Interoperability Matrix Tool で確認できます"^] およびお使いのホストオペレーティングシステムに対応した Host Utilities の『 Installation and Setup Guide 』を参照してください。

ストレージのテイクオーバー、再同期、ギブバックは、すべてデフォルトで自動的に実行されます。ユーザによる操作は必要ありません。



== ストレージ構成

HA ペアは、アクティブ / アクティブ構成として使用できます。アクティブ / アクティブ構成では、両方のノードがクライアントにデータを提供します。アクティブ / パッシブ構成では、パッシブノードは、アクティブノードのストレージをテイクオーバーした場合にのみデータ要求に応答します。
